-/*! lazyload.js v1.0.1 | github.com/OscarDCorbalan/lazyload.js */

(function(f){var g;if(typeof window!=='undefined'){g=window}else if(typeof self!=='undefined'){g=self}g.lazyload=f()})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
module.exports = lazyload;

var inViewport = require('in-viewport');
var lazyAttrs = ['data-src'];

global.lzld = lazyload();
global.inViewport = inViewport;

// Provide libs using getAttribute early to get the good src
// and not the fake data-src
replaceGetAttribute('Image');
replaceGetAttribute('IFrame');

function registerLazyAttr(attr) {
  if (indexOf.call(lazyAttrs, attr) === -1) {
    lazyAttrs.push(attr);
  }
}

function lazyload(opts) {
  opts = merge({
    'offset': 333,
    'src': 'data-src',
    'container': false
  }, opts || {});

  if (typeof opts.src === 'string') {
    registerLazyAttr(opts.src);
  }

  var elts = [];

  function show(elt) {
    var src = findRealSrc(elt);

    if (src) {
      elt.src = src;
    }

    elt.setAttribute('data-lzled', true);
    elts[indexOf.call(elts, elt)] = null;
  }

  function findRealSrc(elt) {
    if (typeof opts.src === 'function') {
      return opts.src(elt);
    }

    return elt.getAttribute(opts.src);
  }

  function register(elt) {
    // unsubscribe onload
    // needed by IE < 9, otherwise we get another onload when changing the src
    elt.onload = null;
    elt.removeAttribute('onload');

    // https://github.com/vvo/lazyload/issues/62
    elt.onerror = null;
    elt.removeAttribute('onerror');

    if (indexOf.call(elts, elt) === -1) {
      inViewport(elt, opts, show);
    }
  }

  return register;
}

function replaceGetAttribute(elementName) {
  var fullname = 'HTML' + elementName + 'Element';
  if (fullname in global === false) {
    return;
  }

  var original = global[fullname].prototype.getAttribute;
  global[fullname].prototype.getAttribute = function(name) {
    if (name === 'src') {
      var realSrc;
      for (var i = 0, max = lazyAttrs.length; i < max; i++) {
        realSrc = original.call(this, lazyAttrs[i]);
        if (realSrc) {
          break;
        }
      }

      return realSrc || original.call(this, name);
    }

    // our own lazyloader will go through theses lines
    // because we use getAttribute(opts.src)
    return original.call(this, name);
  };
}

function merge(defaults, opts) {
  for (var name in defaults) {
    if (opts[name] === undefined) {
      opts[name] = defaults[name];
    }
  }

  return opts;
}

// http://webreflection.blogspot.fr/2011/06/partial-polyfills.html
function indexOf(value) {
  for (var i = this.length; i-- && this[i] !== value;) {}
  return i;
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"in-viewport":2}],2:[function(require,module,exports){
(function (global){
module.exports = inViewport;

var instances = [];
var supportsMutationObserver = typeof global.MutationObserver === 'function';

function inViewport(elt, params, cb) {
  var opts = {
    container: global.document.body,
    offset: 0
  };

  if (params === undefined || typeof params === 'function') {
    cb = params;
    params = {};
  }

  var container = opts.container = params.container || opts.container;
  var offset = opts.offset = params.offset || opts.offset;

  for (var i = 0; i < instances.length; i++) {
    if (instances[i].container === container) {
      return instances[i].isInViewport(elt, offset, cb);
    }
  }

  return instances[
    instances.push(createInViewport(container)) - 1
  ].isInViewport(elt, offset, cb);
}

function addEvent(el, type, fn) {
  if (el.attachEvent) {
    el.attachEvent('on' + type, fn);
  } else {
    el.addEventListener(type, fn, false);
  }
}

function debounce(func, wait, immediate) {
  var timeout;
  return function () {
    var context = this, args = arguments;
    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);

    function later() {
      timeout = null;
      if (!immediate) func.apply(context, args);
    }
  };
}

// https://github.com/jquery/sizzle/blob/3136f48b90e3edc84cbaaa6f6f7734ef03775a07/sizzle.js#L708
var contains = function() {
  if (!global.document) {
    return true;
  }
  return global.document.documentElement.compareDocumentPosition ?
    function (a, b) {
      return !!(a.compareDocumentPosition(b) & 16);
    } :
    global.document.documentElement.contains ?
      function (a, b) {
        return a !== b && ( a.contains ? a.contains(b) : false );
      } :
      function (a, b) {
        while (b = b.parentNode) {
          if (b === a) {
            return true;
          }
        }
        return false;
      };
}

function createInViewport(container) {
  var watches = createWatches();

  var scrollContainer = container === global.document.body ? global : container;
  var debouncedCheck = debounce(watches.checkAll(watchInViewport), 15);

  addEvent(scrollContainer, 'scroll', debouncedCheck);

  if (scrollContainer === global) {
    addEvent(global, 'resize', debouncedCheck);
  }

  if (supportsMutationObserver) {
    observeDOM(watches, container, debouncedCheck);
  }

  // failsafe check, every 200ms we check for visible images
  // usecase: a hidden parent containing eleements
  // when the parent becomes visible, we have no event that the children
  // became visible
  setInterval(debouncedCheck, 150);

  function isInViewport(elt, offset, cb) {
    if (!cb) {
      return isVisible(elt, offset);
    }

    var remote = createRemote(elt, offset, cb);
    remote.watch();
    return remote;
  }

  function createRemote(elt, offset, cb) {
    function watch() {
      watches.add(elt, offset, cb);
    }

    function dispose() {
      watches.remove(elt);
    }

    return {
      watch: watch,
      dispose: dispose
    };
  }

  function watchInViewport(elt, offset, cb) {
    if (isVisible(elt, offset)) {
      watches.remove(elt);
      cb(elt);
    }
  }

  function isVisible(elt, offset) {
    if (!contains(global.document.documentElement, elt) || !contains(global.document.documentElement, container)) {
      return false;
    }

    // Check if the element is visible
    // https://github.com/jquery/jquery/blob/740e190223d19a114d5373758127285d14d6b71e/src/css/hiddenVisibleSelectors.js
    if (!elt.offsetWidth || !elt.offsetHeight) {
      return false;
    }

    var eltRect = elt.getBoundingClientRect();
    var viewport = {};

    if (container === global.document.body) {
      viewport = {
        top: -offset,
        left: -offset,
        right: global.document.documentElement.clientWidth + offset,
        bottom: global.document.documentElement.clientHeight + offset
      };
    } else {
      var containerRect = container.getBoundingClientRect();
      viewport = {
        top: containerRect.top - offset,
        left: containerRect.left - offset,
        right: containerRect.right + offset,
        bottom: containerRect.bottom + offset
      };
    }

    // The element must overlap with the visible part of the viewport
    var visible =
      (
        eltRect.right >= viewport.left &&
        eltRect.left <= viewport.right &&
        eltRect.bottom >= viewport.top &&
        eltRect.top <= viewport.bottom
      );

    return visible;
  }

  return {
    container: container,
    isInViewport: isInViewport
  };
}

function createWatches() {
  var watches = [];

  function add(elt, offset, cb) {
    if (!isWatched(elt)) {
      watches.push([elt, offset, cb]);
    }
  }

  function remove(elt) {
    var pos = indexOf(elt);
    if (pos !== -1) {
      watches.splice(pos, 1);
    }
  }

  function indexOf(elt) {
    for (var i = watches.length - 1; i >= 0; i--) {
      if (watches[i][0] === elt) {
        return i;
      }
    }
    return -1;
  }

  function isWatched(elt) {
    return indexOf(elt) !== -1;
  }

  function checkAll(cb) {
    return function () {
      for (var i = watches.length - 1; i >= 0; i--) {
        cb.apply(this, watches[i]);
      }
    };
  }

  return {
    add: add,
    remove: remove,
    isWatched: isWatched,
    checkAll: checkAll
  };
}

function observeDOM(watches, container, cb) {
  var observer = new MutationObserver(watch);
  var filter = Array.prototype.filter;
  var concat = Array.prototype.concat;

  observer.observe(container, {
    childList: true,
    subtree: true,
    // changes like style/width/height/display will be catched
    attributes: true
  });

  function watch(mutations) {
    // some new DOM nodes where previously watched
    // we should check their positions
    if (mutations.some(knownNodes) === true) {
      setTimeout(cb, 0);
    }
  }

  function knownNodes(mutation) {
    var nodes = concat.call([],
      Array.prototype.slice.call(mutation.addedNodes),
      mutation.target
    );
    return filter.call(nodes, watches.isWatched).length > 0;
  }
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsYXp5bG9hZC5qcyIsIm5vZGVfbW9kdWxlcy9pbi12aWV3cG9ydC9pbi12aWV3cG9ydC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSBsYXp5bG9hZDtcblxudmFyIGluVmlld3BvcnQgPSByZXF1aXJlKCdpbi12aWV3cG9ydCcpO1xudmFyIGxhenlBdHRycyA9IFsnZGF0YS1zcmMnXTtcblxuZ2xvYmFsLmx6bGQgPSBsYXp5bG9hZCgpO1xuZ2xvYmFsLmluVmlld3BvcnQgPSBpblZpZXdwb3J0O1xuXG4vLyBQcm92aWRlIGxpYnMgdXNpbmcgZ2V0QXR0cmlidXRlIGVhcmx5IHRvIGdldCB0aGUgZ29vZCBzcmNcbi8vIGFuZCBub3QgdGhlIGZha2UgZGF0YS1zcmNcbnJlcGxhY2VHZXRBdHRyaWJ1dGUoJ0ltYWdlJyk7XG5yZXBsYWNlR2V0QXR0cmlidXRlKCdJRnJhbWUnKTtcblxuZnVuY3Rpb24gcmVnaXN0ZXJMYXp5QXR0cihhdHRyKSB7XG4gIGlmIChpbmRleE9mLmNhbGwobGF6eUF0dHJzLCBhdHRyKSA9PT0gLTEpIHtcbiAgICBsYXp5QXR0cnMucHVzaChhdHRyKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBsYXp5bG9hZChvcHRzKSB7XG4gIG9wdHMgPSBtZXJnZSh7XG4gICAgJ29mZnNldCc6IDMzMyxcbiAgICAnc3JjJzogJ2RhdGEtc3JjJyxcbiAgICAnY29udGFpbmVyJzogZmFsc2VcbiAgfSwgb3B0cyB8fCB7fSk7XG5cbiAgaWYgKHR5cGVvZiBvcHRzLnNyYyA9PT0gJ3N0cmluZycpIHtcbiAgICByZWdpc3RlckxhenlBdHRyKG9wdHMuc3JjKTtcbiAgfVxuXG4gIHZhciBlbHRzID0gW107XG5cbiAgZnVuY3Rpb24gc2hvdyhlbHQpIHtcbiAgICB2YXIgc3JjID0gZmluZFJlYWxTcmMoZWx0KTtcblxuICAgIGlmIChzcmMpIHtcbiAgICAgIGVsdC5zcmMgPSBzcmM7XG4gICAgfVxuXG4gICAgZWx0LnNldEF0dHJpYnV0ZSgnZGF0YS1semxlZCcsIHRydWUpO1xuICAgIGVsdHNbaW5kZXhPZi5jYWxsKGVsdHMsIGVsdCldID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmRSZWFsU3JjKGVsdCkge1xuICAgIGlmICh0eXBlb2Ygb3B0cy5zcmMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBvcHRzLnNyYyhlbHQpO1xuICAgIH1cblxuICAgIHJldHVybiBlbHQuZ2V0QXR0cmlidXRlKG9wdHMuc3JjKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlZ2lzdGVyKGVsdCkge1xuICAgIC8vIHVuc3Vic2NyaWJlIG9ubG9hZFxuICAgIC8vIG5lZWRlZCBieSBJRSA8IDksIG90aGVyd2lzZSB3ZSBnZXQgYW5vdGhlciBvbmxvYWQgd2hlbiBjaGFuZ2luZyB0aGUgc3JjXG4gICAgZWx0Lm9ubG9hZCA9IG51bGw7XG4gICAgZWx0LnJlbW92ZUF0dHJpYnV0ZSgnb25sb2FkJyk7XG5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdnZvL2xhenlsb2FkL2lzc3Vlcy82MlxuICAgIGVsdC5vbmVycm9yID0gbnVsbDtcbiAgICBlbHQucmVtb3ZlQXR0cmlidXRlKCdvbmVycm9yJyk7XG5cbiAgICBpZiAoaW5kZXhPZi5jYWxsKGVsdHMsIGVsdCkgPT09IC0xKSB7XG4gICAgICBpblZpZXdwb3J0KGVsdCwgb3B0cywgc2hvdyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlZ2lzdGVyO1xufVxuXG5mdW5jdGlvbiByZXBsYWNlR2V0QXR0cmlidXRlKGVsZW1lbnROYW1lKSB7XG4gIHZhciBmdWxsbmFtZSA9ICdIVE1MJyArIGVsZW1lbnROYW1lICsgJ0VsZW1lbnQnO1xuICBpZiAoZnVsbG5hbWUgaW4gZ2xvYmFsID09PSBmYWxzZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBvcmlnaW5hbCA9IGdsb2JhbFtmdWxsbmFtZV0ucHJvdG90eXBlLmdldEF0dHJpYnV0ZTtcbiAgZ2xvYmFsW2Z1bGxuYW1lXS5wcm90b3R5cGUuZ2V0QXR0cmlidXRlID0gZnVuY3Rpb24obmFtZSkge1xuICAgIGlmIChuYW1lID09PSAnc3JjJykge1xuICAgICAgdmFyIHJlYWxTcmM7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbWF4ID0gbGF6eUF0dHJzLmxlbmd0aDsgaSA8IG1heDsgaSsrKSB7XG4gICAgICAgIHJlYWxTcmMgPSBvcmlnaW5hbC5jYWxsKHRoaXMsIGxhenlBdHRyc1tpXSk7XG4gICAgICAgIGlmIChyZWFsU3JjKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlYWxTcmMgfHwgb3JpZ2luYWwuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICB9XG5cbiAgICAvLyBvdXIgb3duIGxhenlsb2FkZXIgd2lsbCBnbyB0aHJvdWdoIHRoZXNlcyBsaW5lc1xuICAgIC8vIGJlY2F1c2Ugd2UgdXNlIGdldEF0dHJpYnV0ZShvcHRzLnNyYylcbiAgICByZXR1cm4gb3JpZ2luYWwuY2FsbCh0aGlzLCBuYW1lKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gbWVyZ2UoZGVmYXVsdHMsIG9wdHMpIHtcbiAgZm9yICh2YXIgbmFtZSBpbiBkZWZhdWx0cykge1xuICAgIGlmIChvcHRzW25hbWVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG9wdHNbbmFtZV0gPSBkZWZhdWx0c1tuYW1lXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb3B0cztcbn1cblxuLy8gaHR0cDovL3dlYnJlZmxlY3Rpb24uYmxvZ3Nwb3QuZnIvMjAxMS8wNi9wYXJ0aWFsLXBvbHlmaWxscy5odG1sXG5mdW5jdGlvbiBpbmRleE9mKHZhbHVlKSB7XG4gIGZvciAodmFyIGkgPSB0aGlzLmxlbmd0aDsgaS0tICYmIHRoaXNbaV0gIT09IHZhbHVlOykge31cbiAgcmV0dXJuIGk7XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGluVmlld3BvcnQ7XG5cbnZhciBpbnN0YW5jZXMgPSBbXTtcbnZhciBzdXBwb3J0c011dGF0aW9uT2JzZXJ2ZXIgPSB0eXBlb2YgZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgPT09ICdmdW5jdGlvbic7XG5cbmZ1bmN0aW9uIGluVmlld3BvcnQoZWx0LCBwYXJhbXMsIGNiKSB7XG4gIHZhciBvcHRzID0ge1xuICAgIGNvbnRhaW5lcjogZ2xvYmFsLmRvY3VtZW50LmJvZHksXG4gICAgb2Zmc2V0OiAwXG4gIH07XG5cbiAgaWYgKHBhcmFtcyA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiBwYXJhbXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYiA9IHBhcmFtcztcbiAgICBwYXJhbXMgPSB7fTtcbiAgfVxuXG4gIHZhciBjb250YWluZXIgPSBvcHRzLmNvbnRhaW5lciA9IHBhcmFtcy5jb250YWluZXIgfHwgb3B0cy5jb250YWluZXI7XG4gIHZhciBvZmZzZXQgPSBvcHRzLm9mZnNldCA9IHBhcmFtcy5vZmZzZXQgfHwgb3B0cy5vZmZzZXQ7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoaW5zdGFuY2VzW2ldLmNvbnRhaW5lciA9PT0gY29udGFpbmVyKSB7XG4gICAgICByZXR1cm4gaW5zdGFuY2VzW2ldLmlzSW5WaWV3cG9ydChlbHQsIG9mZnNldCwgY2IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBpbnN0YW5jZXNbXG4gICAgaW5zdGFuY2VzLnB1c2goY3JlYXRlSW5WaWV3cG9ydChjb250YWluZXIpKSAtIDFcbiAgXS5pc0luVmlld3BvcnQoZWx0LCBvZmZzZXQsIGNiKTtcbn1cblxuZnVuY3Rpb24gYWRkRXZlbnQoZWwsIHR5cGUsIGZuKSB7XG4gIGlmIChlbC5hdHRhY2hFdmVudCkge1xuICAgIGVsLmF0dGFjaEV2ZW50KCdvbicgKyB0eXBlLCBmbik7XG4gIH0gZWxzZSB7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgZmFsc2UpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuICB2YXIgdGltZW91dDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbiAgICBpZiAoY2FsbE5vdykgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcblxuICAgIGZ1bmN0aW9uIGxhdGVyKCkge1xuICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICBpZiAoIWltbWVkaWF0ZSkgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICB9XG4gIH07XG59XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvc2l6emxlL2Jsb2IvMzEzNmY0OGI5MGUzZWRjODRjYmFhYTZmNmY3NzM0ZWYwMzc3NWEwNy9zaXp6bGUuanMjTDcwOFxudmFyIGNvbnRhaW5zID0gZnVuY3Rpb24oKSB7XG4gIGlmICghZ2xvYmFsLmRvY3VtZW50KSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGdsb2JhbC5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24gP1xuICAgIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gISEoYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKSAmIDE2KTtcbiAgICB9IDpcbiAgICBnbG9iYWwuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zID9cbiAgICAgIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhICE9PSBiICYmICggYS5jb250YWlucyA/IGEuY29udGFpbnMoYikgOiBmYWxzZSApO1xuICAgICAgfSA6XG4gICAgICBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB3aGlsZSAoYiA9IGIucGFyZW50Tm9kZSkge1xuICAgICAgICAgIGlmIChiID09PSBhKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSW5WaWV3cG9ydChjb250YWluZXIpIHtcbiAgdmFyIHdhdGNoZXMgPSBjcmVhdGVXYXRjaGVzKCk7XG5cbiAgdmFyIHNjcm9sbENvbnRhaW5lciA9IGNvbnRhaW5lciA9PT0gZ2xvYmFsLmRvY3VtZW50LmJvZHkgPyBnbG9iYWwgOiBjb250YWluZXI7XG4gIHZhciBkZWJvdW5jZWRDaGVjayA9IGRlYm91bmNlKHdhdGNoZXMuY2hlY2tBbGwod2F0Y2hJblZpZXdwb3J0KSwgMTUpO1xuXG4gIGFkZEV2ZW50KHNjcm9sbENvbnRhaW5lciwgJ3Njcm9sbCcsIGRlYm91bmNlZENoZWNrKTtcblxuICBpZiAoc2Nyb2xsQ29udGFpbmVyID09PSBnbG9iYWwpIHtcbiAgICBhZGRFdmVudChnbG9iYWwsICdyZXNpemUnLCBkZWJvdW5jZWRDaGVjayk7XG4gIH1cblxuICBpZiAoc3VwcG9ydHNNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgb2JzZXJ2ZURPTSh3YXRjaGVzLCBjb250YWluZXIsIGRlYm91bmNlZENoZWNrKTtcbiAgfVxuXG4gIC8vIGZhaWxzYWZlIGNoZWNrLCBldmVyeSAyMDBtcyB3ZSBjaGVjayBmb3IgdmlzaWJsZSBpbWFnZXNcbiAgLy8gdXNlY2FzZTogYSBoaWRkZW4gcGFyZW50IGNvbnRhaW5pbmcgZWxlZW1lbnRzXG4gIC8vIHdoZW4gdGhlIHBhcmVudCBiZWNvbWVzIHZpc2libGUsIHdlIGhhdmUgbm8gZXZlbnQgdGhhdCB0aGUgY2hpbGRyZW5cbiAgLy8gYmVjYW1lIHZpc2libGVcbiAgc2V0SW50ZXJ2YWwoZGVib3VuY2VkQ2hlY2ssIDE1MCk7XG5cbiAgZnVuY3Rpb24gaXNJblZpZXdwb3J0KGVsdCwgb2Zmc2V0LCBjYikge1xuICAgIGlmICghY2IpIHtcbiAgICAgIHJldHVybiBpc1Zpc2libGUoZWx0LCBvZmZzZXQpO1xuICAgIH1cblxuICAgIHZhciByZW1vdGUgPSBjcmVhdGVSZW1vdGUoZWx0LCBvZmZzZXQsIGNiKTtcbiAgICByZW1vdGUud2F0Y2goKTtcbiAgICByZXR1cm4gcmVtb3RlO1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlUmVtb3RlKGVsdCwgb2Zmc2V0LCBjYikge1xuICAgIGZ1bmN0aW9uIHdhdGNoKCkge1xuICAgICAgd2F0Y2hlcy5hZGQoZWx0LCBvZmZzZXQsIGNiKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwb3NlKCkge1xuICAgICAgd2F0Y2hlcy5yZW1vdmUoZWx0KTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2F0Y2g6IHdhdGNoLFxuICAgICAgZGlzcG9zZTogZGlzcG9zZVxuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiB3YXRjaEluVmlld3BvcnQoZWx0LCBvZmZzZXQsIGNiKSB7XG4gICAgaWYgKGlzVmlzaWJsZShlbHQsIG9mZnNldCkpIHtcbiAgICAgIHdhdGNoZXMucmVtb3ZlKGVsdCk7XG4gICAgICBjYihlbHQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGlzVmlzaWJsZShlbHQsIG9mZnNldCkge1xuICAgIGlmICghY29udGFpbnMoZ2xvYmFsLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgZWx0KSB8fCAhY29udGFpbnMoZ2xvYmFsLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgY29udGFpbmVyKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHRoZSBlbGVtZW50IGlzIHZpc2libGVcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2pxdWVyeS9ibG9iLzc0MGUxOTAyMjNkMTlhMTE0ZDUzNzM3NTgxMjcyODVkMTRkNmI3MWUvc3JjL2Nzcy9oaWRkZW5WaXNpYmxlU2VsZWN0b3JzLmpzXG4gICAgaWYgKCFlbHQub2Zmc2V0V2lkdGggfHwgIWVsdC5vZmZzZXRIZWlnaHQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgZWx0UmVjdCA9IGVsdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB2YXIgdmlld3BvcnQgPSB7fTtcblxuICAgIGlmIChjb250YWluZXIgPT09IGdsb2JhbC5kb2N1bWVudC5ib2R5KSB7XG4gICAgICB2aWV3cG9ydCA9IHtcbiAgICAgICAgdG9wOiAtb2Zmc2V0LFxuICAgICAgICBsZWZ0OiAtb2Zmc2V0LFxuICAgICAgICByaWdodDogZ2xvYmFsLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCArIG9mZnNldCxcbiAgICAgICAgYm90dG9tOiBnbG9iYWwuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCArIG9mZnNldFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGNvbnRhaW5lclJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2aWV3cG9ydCA9IHtcbiAgICAgICAgdG9wOiBjb250YWluZXJSZWN0LnRvcCAtIG9mZnNldCxcbiAgICAgICAgbGVmdDogY29udGFpbmVyUmVjdC5sZWZ0IC0gb2Zmc2V0LFxuICAgICAgICByaWdodDogY29udGFpbmVyUmVjdC5yaWdodCArIG9mZnNldCxcbiAgICAgICAgYm90dG9tOiBjb250YWluZXJSZWN0LmJvdHRvbSArIG9mZnNldFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBUaGUgZWxlbWVudCBtdXN0IG92ZXJsYXAgd2l0aCB0aGUgdmlzaWJsZSBwYXJ0IG9mIHRoZSB2aWV3cG9ydFxuICAgIHZhciB2aXNpYmxlID1cbiAgICAgIChcbiAgICAgICAgZWx0UmVjdC5yaWdodCA+PSB2aWV3cG9ydC5sZWZ0ICYmXG4gICAgICAgIGVsdFJlY3QubGVmdCA8PSB2aWV3cG9ydC5yaWdodCAmJlxuICAgICAgICBlbHRSZWN0LmJvdHRvbSA+PSB2aWV3cG9ydC50b3AgJiZcbiAgICAgICAgZWx0UmVjdC50b3AgPD0gdmlld3BvcnQuYm90dG9tXG4gICAgICApO1xuXG4gICAgcmV0dXJuIHZpc2libGU7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNvbnRhaW5lcjogY29udGFpbmVyLFxuICAgIGlzSW5WaWV3cG9ydDogaXNJblZpZXdwb3J0XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVdhdGNoZXMoKSB7XG4gIHZhciB3YXRjaGVzID0gW107XG5cbiAgZnVuY3Rpb24gYWRkKGVsdCwgb2Zmc2V0LCBjYikge1xuICAgIGlmICghaXNXYXRjaGVkKGVsdCkpIHtcbiAgICAgIHdhdGNoZXMucHVzaChbZWx0LCBvZmZzZXQsIGNiXSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlKGVsdCkge1xuICAgIHZhciBwb3MgPSBpbmRleE9mKGVsdCk7XG4gICAgaWYgKHBvcyAhPT0gLTEpIHtcbiAgICAgIHdhdGNoZXMuc3BsaWNlKHBvcywgMSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaW5kZXhPZihlbHQpIHtcbiAgICBmb3IgKHZhciBpID0gd2F0Y2hlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgaWYgKHdhdGNoZXNbaV1bMF0gPT09IGVsdCkge1xuICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNXYXRjaGVkKGVsdCkge1xuICAgIHJldHVybiBpbmRleE9mKGVsdCkgIT09IC0xO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tBbGwoY2IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaSA9IHdhdGNoZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY2IuYXBwbHkodGhpcywgd2F0Y2hlc1tpXSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWRkOiBhZGQsXG4gICAgcmVtb3ZlOiByZW1vdmUsXG4gICAgaXNXYXRjaGVkOiBpc1dhdGNoZWQsXG4gICAgY2hlY2tBbGw6IGNoZWNrQWxsXG4gIH07XG59XG5cbmZ1bmN0aW9uIG9ic2VydmVET00od2F0Y2hlcywgY29udGFpbmVyLCBjYikge1xuICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcih3YXRjaCk7XG4gIHZhciBmaWx0ZXIgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyO1xuICB2YXIgY29uY2F0ID0gQXJyYXkucHJvdG90eXBlLmNvbmNhdDtcblxuICBvYnNlcnZlci5vYnNlcnZlKGNvbnRhaW5lciwge1xuICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICBzdWJ0cmVlOiB0cnVlLFxuICAgIC8vIGNoYW5nZXMgbGlrZSBzdHlsZS93aWR0aC9oZWlnaHQvZGlzcGxheSB3aWxsIGJlIGNhdGNoZWRcbiAgICBhdHRyaWJ1dGVzOiB0cnVlXG4gIH0pO1xuXG4gIGZ1bmN0aW9uIHdhdGNoKG11dGF0aW9ucykge1xuICAgIC8vIHNvbWUgbmV3IERPTSBub2RlcyB3aGVyZSBwcmV2aW91c2x5IHdhdGNoZWRcbiAgICAvLyB3ZSBzaG91bGQgY2hlY2sgdGhlaXIgcG9zaXRpb25zXG4gICAgaWYgKG11dGF0aW9ucy5zb21lKGtub3duTm9kZXMpID09PSB0cnVlKSB7XG4gICAgICBzZXRUaW1lb3V0KGNiLCAwKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBrbm93bk5vZGVzKG11dGF0aW9uKSB7XG4gICAgdmFyIG5vZGVzID0gY29uY2F0LmNhbGwoW10sXG4gICAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChtdXRhdGlvbi5hZGRlZE5vZGVzKSxcbiAgICAgIG11dGF0aW9uLnRhcmdldFxuICAgICk7XG4gICAgcmV0dXJuIGZpbHRlci5jYWxsKG5vZGVzLCB3YXRjaGVzLmlzV2F0Y2hlZCkubGVuZ3RoID4gMDtcbiAgfVxufVxuIl19
